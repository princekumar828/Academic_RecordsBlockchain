docker-compose -f docker/docker-compose-net.yaml down --volumes && echo "✓ Network stopped and volumes removed"

----------------

rm -rf organizations/ channel-artifacts/*.block channel-artifacts/*.tx system-genesis-block/*.block *.tar.gz 2>/dev/null; echo "✓ All artifacts cleaned"

----------------

../bin/cryptogen generate --config=./crypto-config.yaml --output="organizations" && echo "✓ Crypto materials generated"

---------------

export FABRIC_CFG_PATH=${PWD}/configtx && ../bin/configtxgen -profile ThreeOrgsOrdererGenesis -channelID system-channel -outputBlock ./system-genesis-block/genesis.block && echo "✓ Genesis block created"

-----------------

docker-compose -f docker/docker-compose-net.yaml up -d && sleep 5 && docker ps --format "table {{.Names}}\t{{.Status}}"

---------------------
Now let's create the channel properly with the updated method. Let me create the channel genesis block and join it to the orderer:
-------------------

export FABRIC_CFG_PATH=${PWD}/configtx && ../bin/configtxgen -profile AcademicRecordsChannel -outputBlock ./channel-artifacts/academic-records-channel.block -channelID academic-records-channel && echo "✓ Channel block created"

----------------------

../bin/osnadmin channel join --channelID academic-records-channel --config-block ./channel-artifacts/academic-records-channel.block -o orderer.nitw.edu:7053 --ca-file "${PWD}/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem" --client-cert "${PWD}/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/tls/server.crt" --client-key "${PWD}/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/tls/server.key" && echo "✓ Channel joined to orderer"


---------------------
Now let's join all peers to the channel. First, I need to copy the channel block to the CLI container:
----------------------




cd /Users/apple/hyperledger/fabric-samples/nit-warangal-network && docker cp ./channel-artifacts/academic-records-channel.block cli:/opt/gopath/src/github.com/hyperledger/fabric/peer/ && docker exec cli sh -c '
export FABRIC_CFG_PATH=/etc/hyperledger/fabric
export CORE_PEER_TLS_ENABLED=true

echo "=== Joining peer0.nitwarangal ==="
export CORE_PEER_LOCALMSPID="NITWarangalMSP"
export CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp
peer channel join -b academic-records-channel.block

echo "=== Joining peer1.nitwarangal ==="
export CORE_PEER_ADDRESS=peer1.nitwarangal.nitw.edu:8051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer1.nitwarangal.nitw.edu/tls/ca.crt
peer channel join -b academic-records-channel.block

echo "=== Joining peer0.departments ==="
export CORE_PEER_LOCALMSPID="DepartmentsMSP"
export CORE_PEER_ADDRESS=peer0.departments.nitw.edu:9051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/users/Admin@departments.nitw.edu/msp
peer channel join -b academic-records-channel.block

echo "=== Joining peer1.departments ==="
export CORE_PEER_ADDRESS=peer1.departments.nitw.edu:10051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer1.departments.nitw.edu/tls/ca.crt
peer channel join -b academic-records-channel.block

echo "=== Joining peer0.verifiers ==="
export CORE_PEER_LOCALMSPID="VerifiersMSP"
export CORE_PEER_ADDRESS=peer0.verifiers.nitw.edu:11051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/peers/peer0.verifiers.nitw.edu/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/users/Admin@verifiers.nitw.edu/msp
peer channel join -b academic-records-channel.block

echo ""
echo "✓ All 5 peers joined successfully!"
'

--------------

cd /Users/apple/hyperledger/fabric-samples/nit-warangal-network/chaincode-go/academic-records && GO111MODULE=on go mod vendor && cd ../.. && export FABRIC_CFG_PATH=../config && ../bin/peer lifecycle chaincode package academic-records.tar.gz --path ./chaincode-go/academic-records --lang golang --label academic_records_1.2 && ls -lh academic-records.tar.gz && echo "✓ Chaincode packaged"

-----
The chaincode package was created successfully. Now I'll install it on the anchor peers (one per organization) and proceed with approval and commit.
-----

docker cp /Users/apple/hyperledger/fabric-samples/nit-warangal-network/academic-records.tar.gz cli:/opt/gopath/src/github.com/hyperledger/fabric/peer/academic-records.tar.gz && echo "✓ Package copied to CLI"

------------------------
nstall the chaincode on the anchor peer of each organization:
-----------------------

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer lifecycle chaincode install academic-records.tar.gz

docker exec -e CORE_PEER_LOCALMSPID=DepartmentsMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/users/Admin@departments.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.departments.nitw.edu:9051 cli peer lifecycle chaincode install academic-records.tar.gz

docker exec -e CORE_PEER_LOCALMSPID=VerifiersMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/peers/peer0.verifiers.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/users/Admin@verifiers.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.verifiers.nitw.edu:11051 cli peer lifecycle chaincode install academic-records.tar.gz


--------------

Perfect! Now I'll approve the chaincode for each organization. The package ID is academic_records_1.2:a37c987afe6085a1ef031ec9affdc0c5ab4a17d3c1b5fa5801a89464275736da.

--------
docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer lifecycle chaincode approveformyorg -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem --channelID academic-records-channel --name academic-records --version 1.2 --package-id academic_records_1.2:a37c987afe6085a1ef031ec9affdc0c5ab4a17d3c1b5fa5801a89464275736da --sequence 1


docker exec -e CORE_PEER_LOCALMSPID=DepartmentsMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/users/Admin@departments.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.departments.nitw.edu:9051 cli peer lifecycle chaincode approveformyorg -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem --channelID academic-records-channel --name academic-records --version 1.2 --package-id academic_records_1.2:a37c987afe6085a1ef031ec9affdc0c5ab4a17d3c1b5fa5801a89464275736da --sequence 1

docker exec -e CORE_PEER_LOCALMSPID=VerifiersMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/peers/peer0.verifiers.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/users/Admin@verifiers.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.verifiers.nitw.edu:11051 cli peer lifecycle chaincode approveformyorg -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem --channelID academic-records-channel --name academic-records --version 1.2 --package-id academic_records_1.2:a37c987afe6085a1ef031ec9affdc0c5ab4a17d3c1b5fa5801a89464275736da --sequence 1

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer lifecycle chaincode checkcommitreadiness --channelID academic-records-channel --name academic-records --version 1.2 --sequence 1 --output json


-----------
Perfect! All three organizations have approved. Now I'll commit the chaincode definition to the channel:
------------

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer lifecycle chaincode commit -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem --channelID academic-records-channel --name academic-records --version 1.2 --sequence 1 --peerAddresses peer0.nitwarangal.nitw.edu:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt --peerAddresses peer0.departments.nitw.edu:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt --peerAddresses peer0.verifiers.nitw.edu:11051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/peers/peer0.verifiers.nitw.edu/tls/ca.crt


----------
Excellent! Now let's verify the chaincode is committed:


-------

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer lifecycle chaincode querycommitted --channelID academic-records-channel --name academic-records

------------------
Perfect! Let's also test the chaincode by invoking it:
-------------------

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer chaincode invoke -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem -C academic-records-channel -n academic-records --peerAddresses peer0.nitwarangal.nitw.edu:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt --peerAddresses peer0.departments.nitw.edu:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt -c '{"function":"CreateStudent","Args":["S001","John Doe","Computer Science","2021","CS21B001","john.doe@student.nitw.ac.in"]}'

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer chaincode query -C academic-records-channel -n academic-records -c '{"function":"GetStudent","Args":["S001"]}'


docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer chaincode invoke -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem -C academic-records-channel -n academic-records --peerAddresses peer0.nitwarangal.nitw.edu:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt --peerAddresses peer0.departments.nitw.edu:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt -c '{"function":"CreateAcademicRecord","Args":["REC001","S001","1","[{\"courseCode\":\"CS101\",\"courseName\":\"Programming\",\"credits\":4,\"grade\":\"A\",\"facultyId\":\"F001\"},{\"courseCode\":\"MA101\",\"courseName\":\"Mathematics\",\"credits\":4,\"grade\":\"S\",\"facultyId\":\"F002\"}]"]}'


docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer chaincode query -C academic-records-channel -n academic-records -c '{"function":"GetAcademicRecord","Args":["REC001"]}'

docker exec -e CORE_PEER_LOCALMSPID=DepartmentsMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/users/Admin@departments.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.departments.nitw.edu:9051 cli peer chaincode invoke -o orderer.nitw.edu:7050 --ordererTLSHostnameOverride orderer.nitw.edu --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/nitw.edu/orderers/orderer.nitw.edu/msp/tlscacerts/tlsca.nitw.edu-cert.pem -C academic-records-channel -n academic-records --peerAddresses peer0.departments.nitw.edu:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/departments.nitw.edu/peers/peer0.departments.nitw.edu/tls/ca.crt --peerAddresses peer0.verifiers.nitw.edu:11051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/verifiers.nitw.edu/peers/peer0.verifiers.nitw.edu/tls/ca.crt -c '{"function":"ApproveAcademicRecord","Args":["REC001"]}'

docker exec -e CORE_PEER_LOCALMSPID=NITWarangalMSP -e CORE_PEER_TLS_ENABLED=true -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/peers/peer0.nitwarangal.nitw.edu/tls/ca.crt -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/peerOrganizations/nitwarangal.nitw.edu/users/Admin@nitwarangal.nitw.edu/msp -e CORE_PEER_ADDRESS=peer0.nitwarangal.nitw.edu:7051 cli peer chaincode query -C academic-records-channel -n academic-records -c '{"function":"GetAcademicRecord","Args":["REC001"]}' | jq
